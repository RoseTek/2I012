PYTHON = python
CC = gcc
CXX = g++
CFLAGS = -pipe -Wall -w -O2
CXXFLAGS = -pipe -Wall -w -O2
CPPFLAGS =-I../qtools -I../src
LEX = lex
AR = ar
RANLIB = ranlib
SRC = config.cpp configoptions.cpp
OBJ = portable_c.o portable.o $(SRC:.cpp=.o)

libdoxycfg.a: $(OBJ)
	$(AR) cru $@ $<
	$(RANLIB) $@
config.cpp: config.l
	$(LEX) -Pconfig YY -t $< > $@
configoptions.cpp: config.xml
	$(PYTHON) configgen.py -cpp $< > $@
%.o: %.cpp
	$(CXX) -c $(CXXFLAGS) $(CPPFLAGS) $<
%.o: %.c
	$(CC) -c $(CFLAGS) $(CPPFLAGS) $<
portable_c.o: portable.h
configoptions.o: configoptions.h
config.o: config.h
clean:
	rm -f $(OBJ) libdoxycfg.a
.PHONY: clean

